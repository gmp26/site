<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Delius">
  <!-- Place favicon.ico and apple-touch-icon.png in the rootUrl directory -->
  <link rel="stylesheet" href="../../styles/main.css">
  <script src="../../scripts/vendor/modernizr.js"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: { 
        equationNumbers: { autoNumber: "AMS" },
        Macros: {
          Var: "\\mathrm{Var}"
        }
      },
      tex2jax: {
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>

  <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</head>
<body>


<div id="wrap1"><div id="wrap2">
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">


        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="muted"><i class="icon-arrow-down"></i> Menu</span>
        </a>

        <!-- Be sure to leave the brand out there if you want it shown -->
        <a class="brand" href="../../index.html"><img src="../../images/cmep-logo3.png" style="height:20px;padding:0px 5px 0px 0px">Cambridge Mathematics</a>


        <span class="clearance">
          clearance 3
        </span>


        <!-- Everything you want hidden at 940px or less, place within here -->
        <div class="nav-collapse collapse">
          <!-- .nav, .navbar-search, .navbar-form, etc -->
          <ul class="nav">
            <li><a href="../../map.html">Tube Map</a></li>
            <li><a href="../../pervasiveIdeasHome.html">Pervasive Ideas</a></li>
            <li><a href="../../resourceTypesHome.html">Resource Types</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>


<div class="container-fluid">
  <div class="row-fluid not-short">
    <div class="container span7 offset1">

      <h1>
        <span class="icon-calendar"></span> Scaffolded task
      </h1>


      <h2>
        Factorial fun
      </h2>


      <div class="tabbable">


        <ul class="nav nav-pills">

          <li class="active">
            <a href="#tab0" data-toggle="tab">
              Problem
            </a>
          </li>

          <li>
            <a href="#tab1" data-toggle="tab">
              Solution
            </a>
          </li>

        </ul>

<script src="../../scripts/tabAddressing.js"></script>


      
        <div class="tab-content">

          <div class="tab-pane active" id="tab0">
            <p>We denote the product of the first <span class="math">\(20\)</span> natural numbers by <span class="math">\(20!\)</span> and call this <span class="math">\(20\)</span> factorial.</p>
<ol type="a">
<li><p>What is the highest power of <span class="math">\(5\)</span> which is a divisor of <span class="math">\(20\)</span> factorial? Just how many factors does <span class="math">\(20!\)</span> have altogether?</p></li>
<li><p>Show that the highest power of <span class="math">\(k\)</span> that divides <span class="math">\(500!\)</span>, where <span class="math">\(k\)</span> is an integer and <span class="math">\(k(t+1)&gt;500&gt;kt\)</span> is</p></li>
</ol>
<p><span class="math">\[[500/k]+[500/k2]+\dots+[500/kt],\]</span></p>
<p>where the square brackets are used to denote the integer part of the number inside.</p>
<ol start="3" type="a">
<li>How many factors does <span class="math">\(n!\)</span> have?</li>
</ol>

          </div>

          <div class="tab-pane" id="tab1">
            <p>(a)</p>
<h5 id="the-highest-power-of-5-dividing-20">The highest power of <span class="math">\(5\)</span> dividing <span class="math">\(20!\)</span></h5>
<p>We have <span class="math">\(20! = 20 \times 19 \times 18 \times \dotsm \times 3 \times 2 \times 1\)</span>.</p>
<p>Since <span class="math">\(5\)</span> is a prime number, we can just add the highest power of <span class="math">\(5\)</span> dividing each of the numbers <span class="math">\(1\)</span>, <span class="math">\(2\)</span>, <span class="math">\(3\)</span>, …, <span class="math">\(20\)</span>. There are only four numbers in this range (<span class="math">\(5\)</span>, <span class="math">\(10\)</span>, <span class="math">\(15\)</span>, <span class="math">\(20\)</span>) that are divisible by <span class="math">\(5^1\)</span>, and none of them is divisible by <span class="math">\(5^2\)</span>. So the highest power of <span class="math">\(5\)</span> dividing <span class="math">\(20!\)</span> is <span class="math">\(5^4\)</span>.</p>
<hr>
<h5 id="factors-of-20">Factors of <span class="math">\(20!\)</span></h5>
<p>The first thing we need to do is find the prime factorisation of <span class="math">\(20!\)</span>. As <span class="math">\(20!=20 \times 19 \times 18 \times \dotsm \times 3 \times 2 \times 1\)</span>, we can can do this by finding the prime factorisation of each of the numbers <span class="math">\(2\)</span>, <span class="math">\(3\)</span>, …, <span class="math">\(20\)</span> (ignoring <span class="math">\(1\)</span> since it won’t contribute any primes) and multiplying them together.</p>
<table>
<col style="width: 12%"><col style="width: 29%"><thead>
<tr class="header">
<th style="text-align: center">Number</th>
<th style="text-align: center">Prime factorisation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center"><span class="math">\(2\)</span></td>
<td style="text-align: center"><span class="math">\(2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(3\)</span></td>
<td style="text-align: center"><span class="math">\(3\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(4\)</span></td>
<td style="text-align: center"><span class="math">\(2^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(5\)</span></td>
<td style="text-align: center"><span class="math">\(5\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(6\)</span></td>
<td style="text-align: center"><span class="math">\(2 \times 3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(7\)</span></td>
<td style="text-align: center"><span class="math">\(7\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(8\)</span></td>
<td style="text-align: center"><span class="math">\(2^3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(9\)</span></td>
<td style="text-align: center"><span class="math">\(3^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(10\)</span></td>
<td style="text-align: center"><span class="math">\(2 \times 5\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(11\)</span></td>
<td style="text-align: center"><span class="math">\(11\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(12\)</span></td>
<td style="text-align: center"><span class="math">\(2^2 \times 3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(13\)</span></td>
<td style="text-align: center"><span class="math">\(13\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(14\)</span></td>
<td style="text-align: center"><span class="math">\(2 \times 7\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(15\)</span></td>
<td style="text-align: center"><span class="math">\(3 \times 5\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(16\)</span></td>
<td style="text-align: center"><span class="math">\(2^4\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(17\)</span></td>
<td style="text-align: center"><span class="math">\(17\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(18\)</span></td>
<td style="text-align: center"><span class="math">\(2 \times 3^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center"><span class="math">\(19\)</span></td>
<td style="text-align: center"><span class="math">\(19\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center"><span class="math">\(20\)</span></td>
<td style="text-align: center"><span class="math">\(2^2 \times 5\)</span></td>
</tr>
</tbody>
</table>
<p>Multiplying the prime factorisations in the right-hand column together and simplifying, we get</p>
<p><span class="math">\(20!=2^{18} \times 3^8 \times 5^4 \times 7^2 \times 11 \times 13 \times 17 \times 19\)</span>.</p>
<p>Now we can use this to calculate the number of divisors of <span class="math">\(20!\)</span>. Each divisor will have a unique prime factorisation, which must be ‘contained’ within the prime factorisation of <span class="math">\(20!\)</span>. Let <span class="math">\(m\)</span> be a divisor of <span class="math">\(20!\)</span>. Then there are nineteen possible values for the highest power of <span class="math">\(2\)</span> dividing <span class="math">\(m\)</span> (<span class="math">\(0\)</span>, <span class="math">\(1\)</span>, …, <span class="math">\(18\)</span>). Similarly, there are nine possible values for the highest power of <span class="math">\(3\)</span> dividing <span class="math">\(m\)</span> (<span class="math">\(0\)</span>, <span class="math">\(1\)</span>, …, <span class="math">\(8\)</span>). Continuing in this way for all the prime factors of <span class="math">\(20!\)</span>, we can calculate that there are <span class="math">\(19 \times 9 \times 5 \times 3 \times 2 \times 2 \times 2 \times 2 = 41040\)</span> divisors of <span class="math">\(20!\)</span>.</p>
<p>(b)</p>
<h5 id="the-highest-power-of-k-that-divides-500-where-kt500kt1">The highest power of <span class="math">\(k\)</span> that divides <span class="math">\(500!\)</span>, where <span class="math">\(k^t&lt;500&lt;k^{t+1}\)</span></h5>
<p>We can see that <span class="math">\(\left[\frac{500}{k}\right]\)</span> is the number of multiples of <span class="math">\(k\)</span> that are less than or equal to <span class="math">\(500\)</span>. For example, if <span class="math">\(k\)</span> goes into <span class="math">\(500\)</span> “seven and a bit” times, this means that <span class="math">\(k\)</span>, <span class="math">\(2k\)</span>, …, <span class="math">\(7k\)</span> are less than <span class="math">\(500\)</span> but <span class="math">\(8k\)</span> is greater than <span class="math">\(500\)</span>.</p>
<p>Similarly, <span class="math">\(\left[\frac{500}{k^2}\right]\)</span> is the number of multiples of <span class="math">\(k^2\)</span> that are less than or equal to <span class="math">\(500\)</span>, and so on.</p>
<p>Now, we can work out the highest power of <span class="math">\(k\)</span> that divides <span class="math">\(500!\)</span> by considering the number of multiples of <span class="math">\(k\)</span>, <span class="math">\(k^2\)</span>, …, <span class="math">\(k^t\)</span> less than <span class="math">\(500\)</span>.</p>
<p>We need to count all the multiples of <span class="math">\(k\)</span>. We need to count the multiples of <span class="math">\(k^2\)</span> twice, since they contribute <span class="math">\(2\)</span> to the exponent, but we have already counted them once in the multiples of <span class="math">\(k\)</span> so we need to count them just once more. Similarly, we need to count the multiples of <span class="math">\(k^3\)</span> three times in total, but we have already counted them twice (once in the multiples of <span class="math">\(k\)</span> and once in the multiples of <span class="math">\(k^2\)</span>), so we need to count them just once more. And so on for the remaining powers. So the highest power of <span class="math">\(k\)</span> that divides <span class="math">\(500!\)</span> has exponent</p>
<p><span class="math">\[\left[\frac{500}{k}\right]+\left[\frac{500}{k^2}\right]+ \dotsb +\left[\frac{500}{k^t}\right]\]</span></p>
<p>(c)</p>
<h5 id="factors-of-n">Factors of <span class="math">\(n!\)</span></h5>
<p>We can generalise the above result beyond the case of <span class="math">\(500!\)</span>. The highest power of <span class="math">\(k\)</span> that divides <span class="math">\(n!\)</span>, where <span class="math">\(k^t &lt; n &lt; k^{t+1}\)</span>, is equal to <span class="math">\[\left[\frac{n}{k}\right] + \left[\frac{n}{k^2}\right] + \dotsb + \left[\frac{n}{k^t}\right],\]</span> by exactly the same reasoning as in (b).</p>
<p>We can use this information to find the prime factorisation of <span class="math">\(n!\)</span>. Let <span class="math">\(p\)</span> be the largest prime with <span class="math">\(p\leq n\)</span>. Also, for any number <span class="math">\(m\)</span>, let <span class="math">\(t_m\)</span> be the integer such that <span class="math">\(m^{t_m} \leq n&lt; m^{t_m+1}\)</span>.</p>
<p>Using the information from part (b), we can then calculate the prime factorisation of <span class="math">\(n!\)</span>: we have</p>
<p><span class="math">\[n! = 2^{\left(\left[\frac{n}{2}\right]+\left[\frac{n}{2^2}\right] + \dotsb +\left[\frac{n}{2^{t_2}}\right]\right)} \times 3^{\left(\left[\frac{n}{3}\right]+\left[\frac{n}{3^3}\right]+ \dotsb +\left[\frac{n}{3^{t_3}}\right]\right)} \times \dotsm \times p^{\left(\left[\frac{n}{p}\right] + \left[\frac{n}{p^2}\right] + \dotsb +\left[\frac{n}{p^{t_p}}\right]\right)}.\]</span></p>
<p>Then we can use the same reasoning as in part (a) to calculate the number of factors of <span class="math">\(n!\)</span>: we get</p>
<p><span class="math">\[\left(1 + \left[\frac{n}{2}\right]+\left[\frac{n}{2^2}\right]+ \dotsb + \left[\frac{n}{2^{t_2}}\right]\right) \times \left(1 + \left[\frac{n}{3}\right] + \left[\frac{n}{3^2}\right] + \dotsb + \left[\frac{n}{3^{t_3}}\right]\right) \times \dotsm\]</span> <span class="math">\[ \times \left(1 + \left[\frac{n}{p}\right] + \left[\frac{n}{p^2}\right] + \dotsb +\left[\frac{n}{p^{t_p}}\right]\right).\]</span></p>
<p>We can check that this expression works for the example of <span class="math">\(20!\)</span>:</p>
<p><span class="math">\[\left(1 + \left[\frac{20}{2}\right]+\left[\frac{20}{4}\right]+\left[\frac{20}{8}\right]+\left[\frac{20}{16}\right] \right) \times \left(1 + \left[\frac{20}{3}\right] + \left[\frac{20}{9}\right]\right) \times \left(1 + \left[\frac{20}{5}\right]\right) \times \left(1 + \left[\frac{20}{7}\right]\right) \times\]</span> <span class="math">\[ \left(1 + \left[\frac{20}{11}\right]\right) \times \left(1 + \left[\frac{20}{13}\right]\right) \times \left(1 + \left[\frac{20}{17}\right]\right) \times \left(1 + \left[\frac{20}{19}\right]\right)\]</span> <span class="math">\[= (10+5+2+1+1) \times (6+2+1) \times (4+1) \times (2+1) \times (1+1) \times (1+1) \times (1+1) \times (1+1)\]</span> <span class="math">\[=19 \times 9 \times 5 \times 3 \times 2 \times 2 \times 2 \times 2 = 41040.\]</span></p>
<p>This is the same answer as in part (a), suggesting that this formula works!</p>

          </div>

        </div>
      </div>
    </div>

    <div id="sidebar" class="offset1 span3">


    <h3>Printables</h3>
    <ul class="unstyled">


      <li>
        <span class="icon-print"></span> <a href="./index.pdf">Problem</a>
      </li>

      <li>
        <span class="icon-print"></span> <a href="./solution.pdf">Solution</a>
      </li>


    </ul>


      <h3>Relevance</h3>

      <div class="station">

        <p><a class="buttonNA" href="../../stations/NA3.html">NA3</a> What are highest common factors and why do they matter?</p>

      </div>

      <ul class="pvi">

      </ul>






    </div>

  </div>


      <span class="small muted pull-right">Last updated 2013-10-23</span>


</div>



<!--[if lt IE 7]>
  <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
<![endif]-->

<!-- Google Analytics: change UA-XXXXX-X to be your site's ID.
<script>
  var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src='//www.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
-->

<script src="../../scripts/main.js"></script>




<script src="../../scripts/vendor/bootstrap.js"></script>

</div> <!-- close #wrap2 -->
</div> <!-- close #wrap1 -->

<div id="footer">
  <div class="container muted">
    <small>
      <p class="credit">
        Unless indicated otherwise, these unpublished materials are currently under development and are copyright © University of Cambridge, Cambridge Mathematics Education Project (CMEP).  All rights reserved.
      </p>
      <p>
        These materials may only be used for CMEP internal developmental and testing purposes under the authority and supervision of the CMEP.  Otherwise, the materials may not be copied in whole or in part in any media or used in any manner or form. Queries: email: cmep@maths.cam.ac.uk phone: 01223 337994.
      </p>
    </small>
    <ul class="inline">
      <li>
        <a class="btn btn-mini btn-inverse" href="../../privacy.html">
          <span class="muted">CMEP Privacy Policy</span>
        </a>
      </li>
      <li>
        <a class="btn btn-mini btn-inverse" href="../../cookies.html">
          <span class="muted">CMEP Cookie Policy</span>
        </a>
      </li>
    </ul>
  </div>
</div>
</body>
</html>